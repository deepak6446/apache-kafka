const mongoose   = require('mongoose');
const crypto     = require('crypto');
const Schema     = mongoose.Schema;


const SessionStoreSchema = new Schema({
    app_uid     : { type : String },
    session_uid : { type : String },
    user_uid    : { type : String },
    session_key : { type : String },
    data        : { type : Schema.Types.Mixed },
    uid 	    : { type : String },
    created_at	: { type : Date, default: Date.now },
    updated_at	: { type : Date, default: Date.now }
});

SessionStoreSchema.pre('save',function(next){
    const id    = 'ss' + crypto.randomBytes(16).toString('hex');
    this.uid  = id;
    next();
});

mongoose.model('SessionStore', SessionStoreSchema)
module.exports = ['SessionStore', SessionStoreSchema]
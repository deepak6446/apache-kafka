const mongoose = require('mongoose')
const crypto = require('crypto')
const Schema = mongoose.Schema


const KVSchema = new Schema({
  flow_uid: { type: String },
  user_uid: { type: String },
  bill_uid: { type: String },
  key: { type: String },
  value: { type: String },
  uid: { type: String },
  created_at: { type: Date, default: Date.now }
})

KVSchema.pre('save', function (next) {
  var id = 'kv' + crypto.randomBytes(18).toString('hex');
  this.uid = id;
  next()
});


mongoose.model('KVStore', KVSchema)
module.exports = ['KVStore', KVSchema]
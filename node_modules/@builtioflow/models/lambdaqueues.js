const mongoose = require('mongoose')
const crypto = require('crypto')
const Schema = mongoose.Schema

const LambdaQueue = new Schema({
  uid: { type: String },
  name: { type: String },
  processing: { type: Boolean, default: false },
  body: { type: Schema.Types.Mixed },
  qurl: { type: String },
  created_at: { type: Date, default: Date.now }
});

LambdaQueue.pre('save', function (next) {
  if (!this || !this.uid) {
    this.uid = 'lamb' + crypto.randomBytes(18).toString('hex')
  }
  next()
})


mongoose.model('LambdaQueue', LambdaQueue)
module.exports = ['LambdaQueue', LambdaQueue]
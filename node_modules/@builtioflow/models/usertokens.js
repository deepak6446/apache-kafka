var mongoose = require('mongoose');
var uuid = require("uuid/v4");
var Schema = mongoose.Schema;

var userTokenSchema = new Schema({
    uid: {
        type: String
    },
    authtoken: {
        type: String
    },
    user_uid: {
        type: String
    },
    last_access_at: {
        type: Date,
        default: null
    },
    idle_valid_till: {
        type: Date,
        default: null
    },
    valid_till: {
        type: Date,
        default: null
    },
    deleted_at: {
        type: Date,
        default: null
    }
}, {
        timestamps: {
            createdAt: 'created_at',
            updatedAt: 'updated_at'
        }
    });

userTokenSchema.pre('save', function (next) {
    var id = 'fl' + uuid();
    this.uid = id;
    next();
});

mongoose.model('UserToken', userTokenSchema);
module.exports = ['UserToken', userTokenSchema];
var mongoose = require('mongoose');
Schema = mongoose.Schema;
const crypto = require('crypto');

var ProjectSchema = new Schema({
    uid: { type: String },
    name: { type: String },
    env_uid: { type: String },
    org_uid: { type: String },
    owner_uid: { type: String },
    created_by: { type: String },
    updated_by: { type: String },
    flow_count: { type: Number, default: 0 },
    icons: [],
    deleted_at: { type: Date, default: null },
    created_at: { type: Date, default: new Date() },
    updated_at: { type: Date, default: new Date() }
});

ProjectSchema.pre('save', function (next) {
    if (!this || !this.uid) {
        this.uid = 'pro' + crypto.randomBytes(18).toString('hex')
    }
    next()
});

mongoose.model('Project', ProjectSchema)
module.exports = ['Project', ProjectSchema]